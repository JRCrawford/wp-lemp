---
# Security role configuration
security_ssh_port: 22
security_ssh_permit_root_login: "no"
security_ssh_usedns: "no"
security_autoupdate_enabled: true
security_autoupdate_reboot: true
security_autoupdate_reboot_time: "01:00"
security_autoupdate_mail_to: ""
security_fail2ban_enabled: true

# Firewall role configurationfirewall_state: started
firewall_state: started
firewall_enabled_at_boot: true
firewall_allowed_tcp_ports:
  - "22"
  - "3962"
  - "80"
  - "443"

# NGINX role configuration
nginx_enable: true
nginx_start: true
nginx_state: present
nginx_install_from: os_repository
nginx_main_template_enable: true
nginx_main_template:
  user: webmaster
  worker_processes: 1
  worker_connections: 1024
  keepalive_timeout: 20

nginx_main_template:
  template_file: nginx.conf.j2
  conf_file_name: nginx.conf
  conf_file_location: /etc/nginx/
  user: webmaster
  worker_processes: "{{ ansible_processor_vcpus }}"
  # worker_rlimit_nofile: 1024
  error_log:
    location: /var/log/nginx/error.log
    level: warn
  worker_connections: 1024
  custom_options: 
    - "include /etc/nginx/modules-enabled/*.conf"
  http_enable: true
  http_settings:
    access_log_format:
      - name: main
        format: |-
          '$remote_addr - $remote_user [$time_local] "$request" '
          '$status $body_bytes_sent "$http_referer" '
          '"$http_user_agent" "$http_x_forwarded_for"'
    access_log_location:
      - name: main
        location: /var/log/nginx/access.log
    tcp_nopush: true
    tcp_nodelay: true
    keepalive_timeout: 20
    cache: false
    rate_limit: false
    keyval: false
    server_tokens: "off"
  http_global_autoindex: false
  http_custom_options: 
    - "types_hash_max_size 2048"
    - "gzip on" 
    - "gzip_types text/plain text/css application/json application/javascript text/xml text/javascript"
    - "ssl_protocols TLSv1.2"
    - "ssl_prefer_server_ciphers on"
    - "include /etc/nginx/sites-enabeld/*"
  events_custom_options:
    - "multi_accept on"
  stream_enable: false
  
# PHP role configuration
php_packages_extra: #
  - php-mysql
#  - php-xml
  - php-xmlrpc
#  - php-curl
# - php-gd
  - php-imagick
  - php-dev
#  - php-imap
#  - php-mbstring
  - php-redis
  - php-soap
  - php-zip
php_enable_webserver: false
php_default_version_debian: "7.2"
php_install_recommends: false
php_enable_php_fpm: true
php_max_execution_time: "300"
php_max_input_time: "300"
php_upload_max_filesize: "64M"
php_post_max_size: "64M"
php_memory_limit: "256M"
php_opcache_enable: "1"
php_opcache_memory_consumption: "128"
php_opcache_interned_strings_buffer: "8"
php_opcache_max_accelerated_files: "4096"
php_opcache_validate_timestamps: "1"
php_opcache_revalidate_path: "0"
php_opcache_revalidate_freq: "60"
php_opcache_max_file_size: "0"
php_opcache_enable_cli: "1"

# MySQL role configuration
mysql_packages:
  - mariadb-client
  - mariadb-server
  - python-mysqldb
mysql_users:
  - name: root
    host: "%"
    state: absent
mysql_enabled_on_startup: true
mysql_user_home: /root
mysql_user_name: root
mysql_user_password: root
