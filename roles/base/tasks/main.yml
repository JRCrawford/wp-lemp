---
- name: Update and upgrade all packages
  become: true
  apt:
    upgrade: yes
    update_cache: yes

- name: Remove dependencies that are no longer required 
  become: true
  apt:
    autoremove: yes

- name: Create a default webmaster user
  become: true
  user:
    name: webmaster
    comment: Web Master
    uid: 1100
  register: webmaster_user

- name: Securing webmaster home directory
  file:
    path: "{{ webmaster_user.home }}"
    mode: 750

- name: Create site folder for NGINX
  file:
    state: directory
    path: "{{ webmaster_user.home }}/{{ domain_name }}"
    owner: "{{ webmaster_user.name }}"
    group: "{{ webmaster_user.group }}"
    mode: 750


- name: Install base packages
  apt: 
    name: "{{ base_packages }}"
    state: present
